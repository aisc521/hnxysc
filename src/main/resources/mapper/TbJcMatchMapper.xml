<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zhcdata.db.mapper.TbJcMatchMapper" >
  <resultMap id="BaseResultMap" type="com.zhcdata.db.model.TbJcMatch" >
    <!--
      WARNING - @mbg.generated
    -->
    <result column="id" property="id" jdbcType="BIGINT" />
    <result column="plan_id" property="planId" jdbcType="BIGINT" />
    <result column="match_id" property="matchId" jdbcType="BIGINT" />
    <result column="match_name" property="matchName" jdbcType="VARCHAR" />
    <result column="match_num" property="matchNum" jdbcType="VARCHAR" />
    <result column="date_of_match" property="dateOfMatch" jdbcType="VARCHAR" />
    <result column="home_team" property="homeTeam" jdbcType="VARCHAR" />
    <result column="visiting_team" property="visitingTeam" jdbcType="VARCHAR" />
    <result column="planInfo" property="planinfo" jdbcType="VARCHAR" />
    <result column="matchResult" property="matchresult" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="createTime" property="createtime" jdbcType="TIMESTAMP" />
  </resultMap>
  <select id="queryList" resultType="com.zhcdata.jc.dto.MatchPlanResult">
    SELECT id id,match_Id matchId,match_num matchNum,match_name matchName,home_team hostTeam,visiting_team visitTeam,date_Of_Match dateOfMatch,planInfo planInfo,status isWin from tb_jc_match
    where plan_id =#{planId} ORDER BY match_num asc
  </select>
  <update id="updateStatus">
    update tb_jc_match set status=#{status},matchResult=#{score} where id=#{id}
  </update>
  <select id="queryList1" resultType="com.zhcdata.jc.dto.MatchPlanResult1">
    SELECT match_Id matchId,match_num matchNum,match_name matchName,home_team hostTeam,visiting_team visitTeam,date_Of_Match dateOfMatch,status,matchResult score,planInfo planInfo,status isWin from tb_jc_match
    where plan_id =#{planId} ORDER BY match_num asc
  </select>


  <select id="queryScore1" resultType="com.zhcdata.jc.dto.MatchResult1">
          SELECT
          class.Name_JS matchName, /*联赛名称*/
          sc.MatchTime matchTime,/*开始时间*/
          t.Name_J homeName,/*主队名称*/
          t2.Name_J guestName,/*客队名称*/
          IFNULL(sc.HomeScore,'0') homeScore,/*主队比分*/
          IFNULL(sc.GuestScore,'0') guestScore,/*客队比分*/
          IFNULL(sc.HomeHalfScore,'0')homeHalfScore,/*主队半场比分*/
          IFNULL(sc.GuestHalfScore,'0') guestHalfScore,/*客队半场比分*/
          t.Flag homeImg,/*主队图标地址*/
          t2.Flag visitImg,/*客队图标地址*/
      CASE
          WHEN sc.MatchState = '0' THEN
          '未开始' /*未开始*/
          WHEN sc.MatchState IN ( '1', '3', '4', '5' ) THEN
          '正在进行' /*正在进行*/
          WHEN sc.MatchState = '2' THEN
          '中场' /*中场*/
          WHEN sc.MatchState = '-1' THEN
          '完结' /*完结*/
          WHEN sc.MatchState = '-14' THEN
          '推迟' /*推迟*/
          WHEN sc.MatchState = '-12' THEN
          '腰斩' /*腰斩*/
          WHEN sc.MatchState = '-10' THEN
          '取消' /*取消*/
          END AS matchState,/*比赛状态*/
      CASE
          WHEN sc.MatchState = '0' THEN
          'notstarted' /*未开始*/
          WHEN sc.MatchState IN ( '1', '3', '4', '5' ) THEN
          'inprogress' /*正在进行*/
          WHEN sc.MatchState = '2' THEN
          'inprogress' /*中场*/
          WHEN sc.MatchState = '-1' THEN
          'finished' /*完结*/
          WHEN sc.MatchState = '-14' THEN
          'notstarted' /*推迟*/
          WHEN sc.MatchState = '-12' THEN
          'cancelled' /*腰斩*/
          WHEN sc.MatchState = '-10' THEN
          'cancelledcancelled' /*取消*/
          END AS statusType,/*比赛大状态*/
      sc.MatchState statusescFK,/*比赛小状态*/
      CASE
          WHEN sc.MatchState IN ( '1', '2' ) THEN
          TIMESTAMPDIFF( MINUTE, sc.MatchTime2, now( 3 ) )
          WHEN sc.MatchState = '3' THEN
          TIMESTAMPDIFF( MINUTE, sc.MatchTime2, now( 3 ) ) + 45 ELSE ''
          END AS makeTime,/*比赛进行分钟数*/
          sc.HomeTeamID homeId,/*主队Id*/
          sc.GuestTeamID visitingId /*客队Id*/
      FROM
          SCHEDULE sc
          LEFT JOIN sclass class ON sc.SclassID = class.sclassID
          LEFT JOIN team t ON sc.HomeTeamID = t.TeamID
          LEFT JOIN team t2 ON sc.GuestTeamID = t2.TeamID
      WHERE
      sc.ScheduleID = #{matchId}
  </select>


    <select id="queryJcMatchByPlanId" resultType="com.zhcdata.db.model.TbJcMatch">
        select * from  tb_jc_match m where m.plan_id = '40' ORDER BY m.date_of_match asc limit 0,1
    </select>

</mapper>